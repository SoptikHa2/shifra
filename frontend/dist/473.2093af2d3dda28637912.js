"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[473],{6888:(_,C,i)=>{i.d(C,{n:()=>r});var d=i(7393);function r(u){return c=>c.lift(new e(u))}class e{constructor(c){this.predicate=c}call(c,l){return l.subscribe(new m(c,this.predicate))}}class m extends d.L{constructor(c,l){super(c),this.predicate=l,this.skipping=!0,this.index=0}_next(c){const l=this.destination;this.skipping&&this.tryCallPredicate(c),this.skipping||l.next(c)}tryCallPredicate(c){try{const l=this.predicate(c,this.index++);this.skipping=Boolean(l)}catch(l){this.destination.error(l)}}}},473:(_,C,i)=>{i.r(C),i.d(C,{TeamModule:()=>V});var d=i(8583),r=i(3679),e=i(7716),m=i(2340),u=i(5304),c=i(8002),l=i(205),U=i(1841),N=i(9075),M=i(4471);let b=(()=>{class n{constructor(t,o,s){this.http=t,this.sanitizer=o,this.loadingService=s}createTeam(t,o){return this.http.post(`${m.N.backendUrl}/api/team/create`,{},{params:{cipher_game_id:o,team_name:t}}).pipe((0,u.K)(s=>(m.N.production||console.error(s),(0,l._)(s))))}getTeamById(t){const o=this.http.get(`${m.N.backendUrl}/api/team/${t}`).pipe((0,c.U)(s=>Object.assign(Object.assign({},s),{QRCode:this.getQRCodeLink(s.invite_code),inviteLink:`${m.N.frontendUrl}/team/join?code=${s.invite_code}`})));return this.loadingService.startLoading(o)}getQRCodeLink(t){return this.sanitizer.bypassSecurityTrustUrl(`${m.N.backendUrl}/api/generateTeamJoinQR/${t}`)}joinTeam(t){return this.http.post(`${m.N.backendUrl}/api/team/join`,{invite_code:t}).pipe((0,u.K)(o=>(m.N.production||console.error(o),(0,l._)(o))))}leaveTeam(t){return this.http.delete(`${m.N.backendUrl}/api/team/leave/${t}`).pipe((0,u.K)(o=>(m.N.production||console.error(o),(0,l._)(o))))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(U.eN),e.LFG(N.H7),e.LFG(M.b))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var p=i(8307),g=i(8295),Z=i(9983),T=i(1095);function A(n,a){if(1&n&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",t.teamNameErrorMessage()," ")}}let j=(()=>{class n{constructor(t,o,s){this.teamService=t,this.router=o,this.route=s,this.teamName=new r.NI("",[r.kI.required,r.kI.minLength(4),r.kI.maxLength(80)]),this.createTeamForm=new r.cw({name:this.teamName})}ngOnInit(){}createTeam(){const t=this.route.snapshot.params.id;this.teamService.createTeam(this.teamName.value,t).subscribe(o=>{o&&this.router.navigate([`/team/${o}/${t}`]).then()},()=>{})}teamNameErrorMessage(){return this.teamName.hasError("required")?"Po\u017eadov\xe1no":this.teamName.hasError("minlength")?"N\xe1zev teamu mus\xed m\xedt alespo\u0148 4 znaky":this.teamName.hasError("maxlength")?"N\xe1zev teamu m\u016f\u017ee m\xedt nejv\xedce 80 znak\u016f":void 0}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(b),e.Y36(p.F0),e.Y36(p.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-create-team"]],decls:14,vars:3,consts:[[3,"formGroup","ngSubmit"],[1,"grow-container","label"],[1,"mat-display-3"],["appearance","outline",1,"form-item"],["matInput","","formControlName","name"],[4,"ngIf"],[1,"error"],[1,"buttons"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"grow-container"]],template:function(t,o){1&t&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return o.createTeam()}),e.TgZ(1,"div",1),e.TgZ(2,"h1",2),e._uU(3,"Zalo\u017eit Team"),e.qZA(),e.qZA(),e.TgZ(4,"mat-form-field",3),e.TgZ(5,"mat-label"),e._uU(6," N\xe1zev teamu "),e.qZA(),e._UZ(7,"input",4),e.YNc(8,A,2,1,"mat-error",5),e.qZA(),e._UZ(9,"div",6),e.TgZ(10,"div",7),e.TgZ(11,"button",8),e._uU(12," Zalo\u017eit "),e.qZA(),e.qZA(),e._UZ(13,"div",9),e.qZA()),2&t&&(e.Q6J("formGroup",o.createTeamForm),e.xp6(8),e.Q6J("ngIf",o.teamName.invalid),e.xp6(3),e.Q6J("disabled",!o.createTeamForm.valid))},directives:[r._Y,r.JL,r.sg,g.KE,g.hX,Z.Nt,r.Fj,r.JJ,r.u,d.O5,T.lW,g.TO],styles:["","form[_ngcontent-%COMP%]{display:flex;height:100%;flex-direction:column;align-items:center;font-size:1.1rem}.form-item[_ngcontent-%COMP%]{width:calc(100% - 256px)}mat-form-field[_ngcontent-%COMP%]{font-size:18px}button[_ngcontent-%COMP%]{width:150px;height:48px;margin:0 8px;font-size:1.1rem}.grow-container[_ngcontent-%COMP%]{display:flex;width:100%;flex:1 1;align-items:center;justify-content:center;box-sizing:border-box}.grow-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:64px 0 0}@media screen and (max-width: 560px){.form-item[_ngcontent-%COMP%]{width:calc(100% - 64px)}.grow-container[_ngcontent-%COMP%]{box-sizing:border-box}.grow-container[_ngcontent-%COMP%]:last-child{min-height:48px;flex-grow:0}}.error[_ngcontent-%COMP%]{padding:12px 0;margin-bottom:16px;text-align:center;border-radius:5px}.buttons[_ngcontent-%COMP%]{display:flex}.label[_ngcontent-%COMP%]{text-align:center;flex:2 1}"]}),n})();var I=i(323),O=i(9773),P=i(6888),k=i(1397),S=i(2238),z=i(9811);function E(n,a){if(1&n&&e._UZ(0,"app-attribute",14),2&n){const t=a.$implicit;e.Q6J("canCopy",!1)("label",t.nickname)}}function Q(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e._uU(3),e.qZA(),e.TgZ(4,"div",3),e.TgZ(5,"div",4),e._UZ(6,"img",5),e.qZA(),e.TgZ(7,"div",6),e.TgZ(8,"div",7),e._UZ(9,"app-attribute",8),e._UZ(10,"app-attribute",9),e.qZA(),e.TgZ(11,"div",7),e._UZ(12,"app-attribute",10),e.qZA(),e.TgZ(13,"div",11),e.YNc(14,E,1,2,"app-attribute",12),e.qZA(),e.TgZ(15,"div",11),e.TgZ(16,"button",13),e.NdJ("click",function(){return e.CHM(t),e.oxw().leaveTeam()}),e._uU(17," Opustit team "),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.BQk()}if(2&n){const t=a.ngIf;e.xp6(3),e.hij(" ",t.name," "),e.xp6(3),e.Q6J("src",t.QRCode,e.LSH),e.xp6(3),e.Q6J("value",t.invite_code),e.xp6(1),e.Q6J("value",t.inviteLink),e.xp6(2),e.Q6J("value",t.members.length+" / "+t.teamMax)("canCopy",!1),e.xp6(2),e.Q6J("ngForOf",t.members)}}let J=(()=>{class n{constructor(t,o,s,h,v){this.teamService=t,this.gameService=o,this.router=s,this.route=h,this.dialog=v}ngOnInit(){this.teamObs=this.teamService.getTeamById(this.route.snapshot.params.id).pipe((0,O.zg)(t=>this.gameService.getGameById(this.route.snapshot.params.cipherId).pipe((0,c.U)(o=>Object.assign(Object.assign({},t),{teamMax:o.teammax})))))}leaveTeam(){this.dialog.open(I.K,{data:{text:"Opravdu chcete opustit team?"}}).afterClosed().pipe((0,P.n)(t=>!t),(0,O.zg)(t=>t?this.teamService.leaveTeam(this.route.snapshot.params.id):t)).subscribe(()=>{this.router.navigate(["/"]).then()},()=>{alert("Nastala chyba na stran\u011b serveru. Zkuste pros\xedm pozd\u011bji!")})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(b),e.Y36(k.h),e.Y36(p.F0),e.Y36(p.gz),e.Y36(S.uw))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-team"]],decls:2,vars:3,consts:[[4,"ngIf"],[1,"flex-container","team-container"],[1,"flex-row","mat-display-3","header-text"],[1,"flex-row"],[1,"flex-item","qr-code"],["alt","QR code",3,"src"],[1,"flex-container",2,"flex","1"],[1,"flex-item",2,"flex-grow","0"],["label","Kl\xed\u010d teamu","icon","vpn_key_outline",3,"value"],["label","Pozv\xe1nkov\xfd link","icon","link",3,"value"],["label","Kapacita","icon","groups",3,"value","canCopy"],[1,"flex-item"],["icon","person",3,"canCopy","label",4,"ngFor","ngForOf"],["mat-raised-button","","color","warn",1,"leave-team-button",3,"click"],["icon","person",3,"canCopy","label"]],template:function(t,o){1&t&&(e.YNc(0,Q,18,7,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,o.teamObs))},directives:[d.O5,z.j,d.sg,T.lW],pipes:[d.Ov],styles:[".header-text[_ngcontent-%COMP%]{justify-content:center}.team-container[_ngcontent-%COMP%]{max-width:calc(100% - 32px);margin:64px 16px 0}.qr-code[_ngcontent-%COMP%]{background:#fafafafa}.qr-code[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%}.team-attribute[_ngcontent-%COMP%]{align-items:center;position:relative}.team-attribute[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{width:32px;height:32px}.qr-code[_ngcontent-%COMP%]{padding:unset}.leave-team-button[_ngcontent-%COMP%]{width:100%;height:64px}",".flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.flex-row[_ngcontent-%COMP%]{display:flex;flex-direction:row}.flex-item[_ngcontent-%COMP%]{flex:1 1 0;border-radius:5px;box-sizing:border-box;border:2px solid #fafafa;margin:8px;padding:24px 32px}.flex-item[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%}@media screen and (max-width: 560px){.flex-item[_ngcontent-%COMP%]{min-width:100%;margin:8px 0}.flex-row[_ngcontent-%COMP%]{flex-wrap:wrap}}"]}),n})();var y=i(6627),F=i(1436),w=i(2458),q=i(4186);let Y=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-join"]],decls:14,vars:0,consts:[["matRipple","","routerLink","qr",1,"main-menu-item","noselect"],["viewBox","0 0 1 1"],[1,"material-icons-outlined"],["matRipple","","routerLink","code",1,"main-menu-item","noselect"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.O4$(),e._UZ(1,"svg",1),e.kcU(),e.TgZ(2,"div"),e.TgZ(3,"mat-icon",2),e._uU(4,"qr_code_scanner"),e.qZA(),e._UZ(5,"br"),e._uU(6," P\u0159ipojit pomoc\xed QR k\xf3du "),e.qZA(),e.qZA(),e.TgZ(7,"div",3),e.O4$(),e._UZ(8,"svg",1),e.kcU(),e.TgZ(9,"div"),e.TgZ(10,"mat-icon",2),e._uU(11,"vpn_key"),e.qZA(),e._UZ(12,"br"),e._uU(13," P\u0159ipojit pomoc\xed kl\xed\u010de "),e.qZA(),e.qZA())},directives:[w.wG,p.rH,y.Hw],styles:["","[_nghost-%COMP%]{display:flex;flex-wrap:wrap;width:100%;height:100%;box-sizing:border-box;overflow-y:auto;overflow-x:hidden;align-items:center;justify-content:center}.main-menu-item[_ngcontent-%COMP%]{border-radius:32px;display:grid;position:relative;flex:1;min-width:256px;margin:32px;border:2px solid white;cursor:pointer;overflow:hidden}.main-menu-item[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{grid-area:1/1}.main-menu-item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:absolute;width:100%;height:100%;top:0;left:0;align-items:center;justify-content:center}.main-menu-item[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px}.filler[_ngcontent-%COMP%]{flex:1;min-width:256px;margin:0 32px;height:0}@media screen and (max-width: 560px){.main-menu-item[_ngcontent-%COMP%]{min-width:calc(100% - 64px);height:calc(50% - 64px);cursor:auto}}"]}),n})();const L=["video"];let R=(()=>{class n{constructor(t){this.router=t}ngOnInit(){}ngAfterViewInit(){this.qrCodeReader=new Html5Qrcode("reader"),this.qrCodeReader.start({facingMode:"environment"},{fps:10,qrbox:250,aspectRatio:1},h=>{this.router.navigate(["/team/join/code"],{queryParams:{code:h.split("=").pop()}}).then().catch(v=>{m.N.production||console.error(v)})}).then(console.error).catch(h=>{m.N.production||console.error(h)})}ngOnDestroy(){this.qrCodeReader&&this.qrCodeReader.stop().then().catch(t=>{m.N.production||console.error(t)})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-qr"]],viewQuery:function(t,o){if(1&t&&e.Gf(L,5),2&t){let s;e.iGM(s=e.CRH())&&(o.videoHtml=s.first)}},decls:1,vars:0,consts:[["id","reader"]],template:function(t,o){1&t&&e._UZ(0,"div",0)},styles:["[_nghost-%COMP%]{display:block;position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden}#reader[_ngcontent-%COMP%]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%)}@media screen and (orientation: landscape){#reader[_ngcontent-%COMP%]{width:100%}}@media screen and (orientation: portrait){#reader[_ngcontent-%COMP%]{width:100vh}}"]}),n})();var G=i(6334);function D(n,a){if(1&n&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",t.usernameErrorMessage()," ")}}function B(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&n&&(e.xp6(1),e.hij(" ","Po\u017eadov\xe1no"," "))}function K(n,a){if(1&n&&(e.TgZ(0,"div",11),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",t.error," ")}}let H=(()=>{class n{constructor(t,o,s,h,v){this.teamService=t,this.authService=o,this.loadingService=s,this.router=h,this.route=v,this.codeControl=new r.NI(this.route.snapshot.queryParamMap.get("code"),[r.kI.required]),this.usernameControl=new r.NI("",[r.kI.required,r.kI.minLength(4),r.kI.maxLength(80)]),this.joinTeamForm=new r.cw({code:this.codeControl,username:this.usernameControl}),this.loadingService.startLoading(this.authService.user.asObservable().pipe((0,P.n)(f=>null==f))).pipe((0,c.U)(f=>f.loggedIn),(0,O.zg)(f=>this.loadingService.loading.asObservable().pipe((0,c.U)(x=>x||f)))).subscribe(f=>{var x;f?(this.usernameControl.disable(),this.usernameControl.setValue(null===(x=this.authService.user.value)||void 0===x?void 0:x.person.nickname)):this.usernameControl.enable()})}ngOnInit(){}joinTeam(){this.teamService.joinTeam(this.codeControl.value).subscribe(t=>{this.router.navigate(["/team",t]).then().catch(o=>{})},t=>{t.status>=400&&t.status<500?this.error="Nepoda\u0159ilo se p\u0159ipojit k teamu":t.status>=500&&(this.error="Stala se chyba na stran\u011b serveru")})}usernameErrorMessage(){return this.usernameControl.hasError("required")?"Po\u017eadov\xe1no":this.usernameControl.hasError("minlength")?"U\u017eivatelsk\xe9 jm\xe9no mus\xed m\xedt alenpo\u0148 4 znaky":this.usernameControl.hasError("maxlength")?"U\u017eivatelsk\xe9 jm\xe9no mus\xed m\xedt nev\xedce 80 znak\u016f":void 0}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(b),e.Y36(G.e),e.Y36(M.b),e.Y36(p.F0),e.Y36(p.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-code"]],decls:19,vars:5,consts:[[3,"formGroup","ngSubmit"],[1,"grow-container","label"],[1,"mat-display-3"],["appearance","outline",1,"form-item"],["matInput","","formControlName","username"],[4,"ngIf"],["matInput","","formControlName","code"],["class","error form-item",4,"ngIf"],[1,"buttons"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"grow-container"],[1,"error","form-item"]],template:function(t,o){1&t&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return o.joinTeam()}),e.TgZ(1,"div",1),e.TgZ(2,"h1",2),e._uU(3,"P\u0159ipojit se k teamu"),e.qZA(),e.qZA(),e.TgZ(4,"mat-form-field",3),e.TgZ(5,"mat-label"),e._uU(6," U\u017eivatelsk\xe9 jm\xe9no "),e.qZA(),e._UZ(7,"input",4),e.YNc(8,D,2,1,"mat-error",5),e.qZA(),e.TgZ(9,"mat-form-field",3),e.TgZ(10,"mat-label"),e._uU(11," k\xf3d "),e.qZA(),e._UZ(12,"input",6),e.YNc(13,B,2,1,"mat-error",5),e.qZA(),e.YNc(14,K,2,1,"div",7),e.TgZ(15,"div",8),e.TgZ(16,"button",9),e._uU(17," P\u0159idat se "),e.qZA(),e.qZA(),e._UZ(18,"div",10),e.qZA()),2&t&&(e.Q6J("formGroup",o.joinTeamForm),e.xp6(8),e.Q6J("ngIf",o.usernameControl.valid),e.xp6(5),e.Q6J("ngIf",o.codeControl.invalid),e.xp6(1),e.Q6J("ngIf",o.error),e.xp6(2),e.Q6J("disabled",!o.joinTeamForm.valid))},directives:[r._Y,r.JL,r.sg,g.KE,g.hX,Z.Nt,r.Fj,r.JJ,r.u,d.O5,T.lW,g.TO],styles:["","form[_ngcontent-%COMP%]{display:flex;height:100%;flex-direction:column;align-items:center;font-size:1.1rem}.form-item[_ngcontent-%COMP%]{width:calc(100% - 256px)}mat-form-field[_ngcontent-%COMP%]{font-size:18px}button[_ngcontent-%COMP%]{width:150px;height:48px;margin:0 8px;font-size:1.1rem}.grow-container[_ngcontent-%COMP%]{display:flex;width:100%;flex:1 1;align-items:center;justify-content:center;box-sizing:border-box}.grow-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:64px 0 0}@media screen and (max-width: 560px){.form-item[_ngcontent-%COMP%]{width:calc(100% - 64px)}.grow-container[_ngcontent-%COMP%]{box-sizing:border-box}.grow-container[_ngcontent-%COMP%]:last-child{min-height:48px;flex-grow:0}}.error[_ngcontent-%COMP%]{padding:12px 0;margin-bottom:16px;text-align:center;border-radius:5px}.buttons[_ngcontent-%COMP%]{display:flex}.label[_ngcontent-%COMP%]{text-align:center;flex:2 1}"]}),n})();var W=i(1347);const X=[{path:"create/:id",component:j,canActivate:[q.e]},{path:"join",component:Y},{path:"join/qr",component:R},{path:"join/code",component:H},{path:":id/:cipherId",component:J}];let V=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[b],imports:[[d.ez,p.Bz.forChild(X),r.UX,g.lN,Z.c,T.ot,y.Ps,F.AV,w.si,W.t]]}),n})()}}]);